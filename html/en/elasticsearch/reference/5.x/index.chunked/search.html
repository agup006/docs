<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Search APIs
        | Elasticsearch Reference [5.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="up" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="prev" href="docs-refresh.html" title="?refresh" /><link rel="next" href="search-search.html" title="Search" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.x]
    </a></span> » <span class="breadcrumb-node">Search APIs</span></div><div xmlns="" class="navheader"><span class="prev"><a href="docs-refresh.html">
              « 
              <code xmlns="http://www.w3.org/1999/xhtml" class="literal">?refresh</code></a>
           
        </span><span class="next">
           
          <a href="search-search.html">Search
               »
            </a></span></div><div class="part"><div class="titlepage"><div><div><h1 class="title"><a id="search"></a>Search APIs<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h1></div></div></div><div class="partintro"><div></div><p>Most search APIs are <a class="link" href="search-search.html#search-multi-index-type" title="Multi-Index, Multi-Typeedit">multi-index, multi-type</a>, with the
exception of the <a class="xref" href="search-explain.html" title="Explain API"><em>Explain API</em></a> endpoints.</p><h2><a id="search-routing"></a>Routing<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2><p>When executing a search, it will be broadcast to all the index/indices
shards (round robin between replicas). Which shards will be searched on
can be controlled by providing the <code class="literal">routing</code> parameter. For example,
when indexing tweets, the routing value can be the user name:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">POST /twitter/tweet?routing=kimchy
{
    "user" : "kimchy",
    "postDate" : "2009-11-15T14:12:12",
    "message" : "trying out Elasticsearch"
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><p>In such a case, if we want to search only on the tweets for a specific
user, we can specify it as the routing, resulting in the search hitting
only the relevant shard:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">POST /twitter/tweet/_search?routing=kimchy
{
    "query": {
        "bool" : {
            "must" : {
                "query_string" : {
                    "query" : "some query string here"
                }
            },
            "filter" : {
                "term" : { "user" : "kimchy" }
            }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><p>The routing parameter can be multi valued represented as a comma
separated string. This will result in hitting the relevant shards where
the routing values match to.</p><h2><a id="stats-groups"></a>Stats Groups<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2><p>A search can be associated with stats groups, which maintains a
statistics aggregation per group. It can later be retrieved using the
<a class="link" href="indices-stats.html" title="Indices Stats">indices stats</a> API
specifically. For example, here is a search body request that associate
the request with two different groups:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">POST /_search
{
    "query" : {
        "match_all" : {}
    },
    "stats" : ["group1", "group2"]
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><h2><a id="global-search-timeout"></a>Global Search Timeout<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2><p>Individual searches can have a timeout as part of the
<a class="xref" href="search-request-body.html" title="Request Body Search"><em>Request Body Search</em></a>. Since search requests can originate from many
sources, Elasticsearch has a dynamic cluster-level setting for a global
search timeout that applies to all search requests that do not set a
timeout in the <a class="xref" href="search-request-body.html" title="Request Body Search"><em>Request Body Search</em></a>. The default value is no global
timeout. The setting key is <code class="literal">search.default_search_timeout</code> and can be
set using the <a class="xref" href="cluster-update-settings.html" title="Cluster Update Settings"><em>Cluster Update Settings</em></a> endpoints. Setting this value
to <code class="literal">-1</code> resets the global search timeout to no timeout.</p><h2><a id="global-search-cancellation"></a>Search Cancellation<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2><p>Searches can be cancelled using standard <a class="link" href="tasks.html#task-cancellation" title="Task Cancellationedit">task cancellation</a>
mechanism. By default, a running search only checks if it is cancelled or
not on segment boundaries, therefore the cancellation can be delayed by large
segments. The search cancellation responsiveness can be improved by setting
the dynamic cluster-level setting <code class="literal">search.low_level_cancellation</code> to <code class="literal">true</code>.
However, it comes with an additional overhead of more frequent cancellation
checks that can be noticeable on large fast running search queries. Changing this
setting only affects the searches that start after the change is made.</p></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="docs-refresh.html">
              « 
              <code xmlns="http://www.w3.org/1999/xhtml" class="literal">?refresh</code></a>
           
        </span><span class="next">
           
          <a href="search-search.html">Search
               »
            </a></span></div></body></html>