<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Set JVM heap size via jvm.options
        | Elasticsearch Reference [5.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="up" href="system-config.html" title="Important System Configuration" /><link rel="prev" href="setting-system-settings.html" title="Configuring system settings" /><link rel="next" href="setup-configuration-memory.html" title="Disable swapping" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.x]
    </a></span> » <span class="breadcrumb-link"><a href="setup.html">Setup Elasticsearch</a></span> » <span class="breadcrumb-link"><a href="system-config.html">Important System Configuration</a></span> » <span class="breadcrumb-node">Set JVM heap size via jvm.options</span></div><div xmlns="" class="navheader"><span class="prev"><a href="setting-system-settings.html">
              « 
              Configuring system settings</a>
           
        </span><span class="next">
           
          <a href="setup-configuration-memory.html">Disable swapping
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="heap-size"></a>Set JVM heap size via jvm.options<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/setup/sysconfig/heap_size.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>By default, Elasticsearch tells the JVM to use a heap with a minimum
and maximum size of 2 GB. When moving to production, it is
important to configure heap size to ensure that Elasticsearch has enough
heap available.</p><p>Elasticsearch will assign the entire heap specified in <a class="link" href="setting-system-settings.html#jvm-options" title="Setting JVM options">jvm.options</a>
via the Xms (minimum heap size) and Xmx (maximum heap size) settings.</p><p>The value for these setting depends on the amount of RAM available on
your server. Good rules of thumb are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Set the minimum heap size (Xms) and maximum heap size (Xmx) to be
  equal to each other.
</li><li class="listitem">
The more heap available to Elasticsearch, the more memory it can use for
  caching. But note that too much heap can subject you to long garbage
  collection pauses.
</li><li class="listitem">
Set Xmx to no more than 50% of your physical RAM, to ensure that there
  is enough physical RAM left for kernel file system caches.
</li><li class="listitem"><p class="simpara">
Don’t set Xmx to above the cutoff that the JVM uses for compressed
  object pointers (compressed oops); the exact cutoff varies but is
  near 32 GB. You can verify that you are under the limit by looking
  for a line in the logs like the following:
</p><pre class="literallayout">heap size [1.9gb], compressed ordinary object pointers [true]</pre></li><li class="listitem"><p class="simpara">
Even better, try to stay below the threshold for zero-based
  compressed oops; the exact cutoff varies but 26 GB is safe on most
  systems, but can be as large as 30 GB on some systems. You can verify
  that you are under the limit by starting Elasticsearch with the JVM
  options <code class="literal">-XX:+UnlockDiagnosticVMOptions -XX:+PrintCompressedOopsMode</code>
  and looking for a line like the following:
</p><pre class="literallayout">heap address: 0x000000011be00000, size: 27648 MB, zero based Compressed Oops</pre><p class="simpara">showing that zero-based compressed oops are enabled instead of</p><pre class="literallayout">heap address: 0x0000000118400000, size: 28672 MB, Compressed Oops with base: 0x00000001183ff000</pre></li></ul></div><p>Here are examples of how to set the heap size via the jvm.options file:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-txt">-Xms2g <a id="CO5-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
-Xmx2g <a id="CO5-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO5-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the minimum heap size to 2g.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO5-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the maximum heap size to 2g.
</p></td></tr></table></div><p>It is also possible to set the heap size via an environment variable.
This can be done by commenting out the <code class="literal">Xms</code> and <code class="literal">Xmx</code> settings
in the jvm.options file and setting these values via <code class="literal">ES_JAVA_OPTS</code>:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-sh">ES_JAVA_OPTS="-Xms2g -Xmx2g" ./bin/elasticsearch <a id="CO6-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
ES_JAVA_OPTS="-Xms4000m -Xmx4000m" ./bin/elasticsearch <a id="CO6-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the minimum and maximum heap size to 2 GB.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
Set the minimum and maximum heap size to 4000 MB.
</p></td></tr></table></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">Configuring the heap for the <a class="link" href="windows.html#windows-service" title="Installing Elasticsearch as a Service on Windows">Windows service</a>
is different than the above. The values initially populated for the
Windows service can be configured as above but are different after the
service has been installed. Consult the
<a class="link" href="windows.html#windows-service" title="Installing Elasticsearch as a Service on Windows">Windows service documentation</a> for additional
details.</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="setting-system-settings.html">
              « 
              Configuring system settings</a>
           
        </span><span class="next">
           
          <a href="setup-configuration-memory.html">Disable swapping
               »
            </a></span></div></body></html>