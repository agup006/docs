<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Returning the type of the aggregation
        | Elasticsearch Reference [5.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="up" href="search-aggregations.html" title="Aggregations" /><link rel="prev" href="agg-metadata.html" title="Aggregation Metadata" /><link rel="next" href="indices.html" title="Indices APIs" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.x]
    </a></span> » <span class="breadcrumb-link"><a href="search-aggregations.html">Aggregations</a></span> » <span class="breadcrumb-node">Returning the type of the aggregation</span></div><div xmlns="" class="navheader"><span class="prev"><a href="agg-metadata.html">
              « 
              Aggregation Metadata</a>
           
        </span><span class="next">
           
          <a href="indices.html">Indices APIs
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="returning-aggregation-type"></a>Returning the type of the aggregation<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/aggregations/misc.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Sometimes you need to know the exact type of an aggregation in order to parse its results. The <code class="literal">typed_keys</code> parameter
 can be used to change the aggregation’s name in the response so that it will be prefixed by its internal type.</p><p>Considering the following <a class="link" href="search-aggregations-bucket-datehistogram-aggregation.html" title="Date Histogram Aggregation"><code class="literal">date_histogram</code> aggregation</a> named
<code class="literal">tweets_over_time</code> which has a sub <a class="link" href="search-aggregations-metrics-top-hits-aggregation.html" title="Top hits Aggregation">'top_hits` aggregation</a> named
 <code class="literal">top_users</code>:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /twitter/tweet/_search?typed_keys
{
  "aggregations": {
    "tweets_over_time": {
      "date_histogram": {
        "field": "date",
        "interval": "year"
      },
      "aggregations": {
        "top_users": {
            "top_hits": {
                "size": 1
            }
        }
      }
    }
  }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><p>In the response, the aggregations names will be changed to respectively <code class="literal">date_histogram#tweets_over_time</code> and
<code class="literal">top_hits#top_users</code>, reflecting the internal types of each aggregation:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "aggregations": {
        "date_histogram#tweets_over_time": { <a id="CO117-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
            "buckets" : [
                {
                    "key_as_string" : "2009-01-01T00:00:00.000Z",
                    "key" : 1230768000000,
                    "doc_count" : 5,
                    "top_hits#top_users" : {  <a id="CO117-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span>
                        "hits" : {
                            "total" : 5,
                            "max_score" : 1.0,
                            "hits" : [
                                {
                                  "_index": "twitter",
                                  "_type": "tweet",
                                  "_id": "0",
                                  "_score": 1.0,
                                  "_source": {
                                    "date": "2009-11-15T14:12:12",
                                    "message": "trying out Elasticsearch",
                                    "user": "kimchy",
                                    "likes": 0
                                  }
                                }
                            ]
                        }
                    }
                }
            ]
        }
    },
    ...
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO117-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name <code class="literal">tweets_over_time</code> now contains the <code class="literal">date_histogram</code> prefix.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO117-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
The name <code class="literal">top_users</code> now contains the <code class="literal">top_hits</code> prefix.
</p></td></tr></table></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">For some aggregations, it is possible that the returned type is not the same as the one provided with the
request. This is the case for Terms, Significant Terms and Percentiles aggregations, where the returned type
also contains information about the type of the targeted field: <code class="literal">lterms</code> (for a terms aggregation on a Long field),
 <code class="literal">sigsterms</code> (for a significant terms aggregation on a String field), <code class="literal">tdigest_percentiles</code> (for a percentile
 aggregation based on the TDigest algorithm).</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="agg-metadata.html">
              « 
              Aggregation Metadata</a>
           
        </span><span class="next">
           
          <a href="indices.html">Indices APIs
               »
            </a></span></div></body></html>