<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Count API
        | Elasticsearch Reference [5.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="up" href="search.html" title="Search APIs" /><link rel="prev" href="search-multi-search.html" title="Multi Search API" /><link rel="next" href="search-validate.html" title="Validate API" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.x]
    </a></span> » <span class="breadcrumb-link"><a href="search.html">Search APIs</a></span> » <span class="breadcrumb-node">Count API</span></div><div xmlns="" class="navheader"><span class="prev"><a href="search-multi-search.html">
              « 
              Multi Search API</a>
           
        </span><span class="next">
           
          <a href="search-validate.html">Validate API
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="search-count"></a>Count API<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The count API allows to easily execute a query and get the number of
matches for that query. It can be executed across one or more indices
and across one or more types. The query can either be provided using a
simple query string as a parameter, or using the
<a class="link" href="query-dsl.html" title="Query DSL">Query DSL</a> defined within the request
body. Here is an example:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">PUT /twitter/tweet/1?refresh
{
    "user": "kimchy"
}

GET /twitter/tweet/_count?q=user:kimchy

GET /twitter/tweet/_count
{
    "query" : {
        "term" : { "user" : "kimchy" }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><div xmlns="" class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml">The query being sent in the body must be nested in a <code class="literal">query</code> key, same as
the <a class="link" href="search-search.html" title="Search">search api</a> works</p></div></div><p>Both examples above do the same thing, which is count the number of
tweets from the twitter index for a certain user. The result is:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
    "count" : 1,
    "_shards" : {
        "total" : 5,
        "successful" : 5,
        "failed" : 0
    }
}</pre></div><p>The query is optional, and when not provided, it will use <code class="literal">match_all</code> to
count all the docs.</p><h3><a id="_multi_index_multi_type"></a>Multi index, Multi type<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The count API can be applied to <a class="link" href="search-search.html#search-multi-index-type" title="Multi-Index, Multi-Typeedit">multiple types in multiple indices</a>.</p><h3><a id="_request_parameters"></a>Request Parameters<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>When executing count using the query parameter <code class="literal">q</code>, the query passed is
a query string using Lucene query parser. There are additional
parameters that can be passed:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Name </th><th align="left" valign="top">Description</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">df</code></p></td><td align="left" valign="top"><p>The default field to use when no field prefix is defined within the
query.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">analyzer</code></p></td><td align="left" valign="top"><p>The analyzer name to be used when analyzing the query string.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">default_operator</code></p></td><td align="left" valign="top"><p>The default operator to be used, can be <code class="literal">AND</code> or
<code class="literal">OR</code>. Defaults to <code class="literal">OR</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">lenient</code></p></td><td align="left" valign="top"><p>If set to true will cause format based failures (like
providing text to a numeric field) to be ignored. Defaults to false.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">analyze_wildcard</code></p></td><td align="left" valign="top"><p>Should wildcard and prefix queries be analyzed or
not. Defaults to <code class="literal">false</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">terminate_after</code></p></td><td align="left" valign="top"><p>The maximum count for each shard, upon
reaching which the query execution will terminate early.
If set, the response will have a boolean field <code class="literal">terminated_early</code> to
indicate whether the query execution has actually terminated_early.
Defaults to no terminate_after.</p></td></tr></tbody></table></div><h3><a id="_request_body"></a>Request Body<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The count can use the <a class="link" href="query-dsl.html" title="Query DSL">Query DSL</a> within
its body in order to express the query that should be executed. The body
content can also be passed as a REST parameter named <code class="literal">source</code>.</p><p>Both HTTP GET and HTTP POST can be used to execute count with body.
Since not all clients support GET with body, POST is allowed as well.</p><h3><a id="_distributed"></a>Distributed<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The count operation is broadcast across all shards. For each shard id
group, a replica is chosen and executed against it. This means that
replicas increase the scalability of count.</p><h3><a id="_routing"></a>Routing<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/search/count.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The routing value (a comma separated list of the routing values) can be
specified to control which shards the count request will be executed on.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="search-multi-search.html">
              « 
              Multi Search API</a>
           
        </span><span class="next">
           
          <a href="search-validate.html">Validate API
               »
            </a></span></div></body></html>