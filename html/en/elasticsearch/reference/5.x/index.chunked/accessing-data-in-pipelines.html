<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Accessing Data in Pipelines
        | Elasticsearch Reference [5.x]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.x]" /><link rel="up" href="ingest.html" title="Ingest Node" /><link rel="prev" href="simulate-pipeline-api.html" title="Simulate Pipeline API" /><link rel="next" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.x" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.x]
    </a></span> » <span class="breadcrumb-link"><a href="ingest.html">Ingest Node</a></span> » <span class="breadcrumb-node">Accessing Data in Pipelines</span></div><div xmlns="" class="navheader"><span class="prev"><a href="simulate-pipeline-api.html">
              « 
              Simulate Pipeline API</a>
           
        </span><span class="next">
           
          <a href="handling-failure-in-pipelines.html">Handling Failures in Pipelines
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="accessing-data-in-pipelines"></a>Accessing Data in Pipelines<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/ingest/ingest-node.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The processors in a pipeline have read and write access to documents that pass through the pipeline.
The processors can access fields in the source of a document and the document’s metadata fields.</p><h3><a id="accessing-source-fields"></a>Accessing Fields in the Source<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/ingest/ingest-node.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Accessing a field in the source is straightforward. You simply refer to fields by
their name. For example:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "my_field"
    "value": 582.1
  }
}</pre></div><p>On top of this, fields from the source are always accessible via the <code class="literal">_source</code> prefix:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "_source.my_field"
    "value": 582.1
  }
}</pre></div><h3><a id="accessing-metadata-fields"></a>Accessing Metadata Fields<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/ingest/ingest-node.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can access metadata fields in the same way that you access fields in the source. This
is possible because Elasticsearch doesn’t allow fields in the source that have the
same name as metadata fields.</p><p>The following example sets the <code class="literal">_id</code> metadata field of a document to <code class="literal">1</code>:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "_id"
    "value": "1"
  }
}</pre></div><p>The following metadata fields are accessible by a processor: <code class="literal">_index</code>, <code class="literal">_type</code>, <code class="literal">_id</code>, <code class="literal">_routing</code>, <code class="literal">_parent</code>.</p><h3><a id="accessing-ingest-metadata"></a>Accessing Ingest Metadata Fields<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/ingest/ingest-node.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Beyond metadata fields and source fields, ingest also adds ingest metadata to the documents that it processes.
These metadata properties are accessible under the <code class="literal">_ingest</code> key. Currently ingest adds the ingest timestamp
under the <code class="literal">_ingest.timestamp</code> key of the ingest metadata. The ingest timestamp is the time when Elasticsearch
received the index or bulk request to pre-process the document.</p><p>Any processor can add ingest-related metadata during document processing. Ingest metadata is transient
and is lost after a document has been processed by the pipeline. Therefore, ingest metadata won’t be indexed.</p><p>The following example adds a field with the name <code class="literal">received</code>. The value is the ingest timestamp:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "received"
    "value": "{{_ingest.timestamp}}"
  }
}</pre></div><p>Unlike Elasticsearch metadata fields, the ingest metadata field name <code class="literal">_ingest</code> can be used as a valid field name
in the source of a document. Use <code class="literal">_source._ingest</code> to refer to the field in the source document. Otherwise, <code class="literal">_ingest</code>
will be interpreted as an ingest metadata field.</p><h3><a id="accessing-template-fields"></a>Accessing Fields and Metafields in Templates<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.x/docs/reference/ingest/ingest-node.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>A number of processor settings also support templating. Settings that support templating can have zero or more
template snippets. A template snippet begins with <code class="literal">{{</code> and ends with <code class="literal">}}</code>.
Accessing fields and metafields in templates is exactly the same as via regular processor field settings.</p><p>The following example adds a field named <code class="literal">field_c</code>. Its value is a concatenation of
the values of <code class="literal">field_a</code> and <code class="literal">field_b</code>.</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "field_c"
    "value": "{{field_a}} {{field_b}}"
  }
}</pre></div><p>The following example uses the value of the <code class="literal">geoip.country_iso_code</code> field in the source
to set the index that the document will be indexed into:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "set": {
    "field": "_index"
    "value": "{{geoip.country_iso_code}}"
  }
}</pre></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="simulate-pipeline-api.html">
              « 
              Simulate Pipeline API</a>
           
        </span><span class="next">
           
          <a href="handling-failure-in-pipelines.html">Handling Failures in Pipelines
               »
            </a></span></div></body></html>