<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Search and Query DSL changes
        | Elasticsearch Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [master]" /><link rel="up" href="breaking-changes-6.0.html" title="Breaking changes in 6.0" /><link rel="prev" href="_delete_by_query_api_requires_an_explicit_query.html" title="Delete by Query API requires an explicit query" /><link rel="next" href="breaking_60_aggregations_changes.html" title="Aggregations changes" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/master" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span> » <span class="breadcrumb-link"><a href="breaking-changes-6.0.html">Breaking changes in 6.0</a></span> » <span class="breadcrumb-node">Search and Query DSL changes</span></div><div xmlns="" class="navheader"><span class="prev"><a href="_delete_by_query_api_requires_an_explicit_query.html">
              « 
              Delete by Query API requires an explicit query</a>
           
        </span><span class="next">
           
          <a href="breaking_60_aggregations_changes.html">Aggregations changes
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="breaking_60_search_changes"></a>Search and Query DSL changes<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_to_queries"></a>Changes to queries<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">collect_payloads</code> parameter of the <code class="literal">span_near</code> query has been removed. Payloads will be
  loaded when needed.
</li><li class="listitem">
Queries on boolean fields now strictly parse boolean-like values. This means
  only the strings <code class="literal">"true"</code> and <code class="literal">"false"</code> will be parsed into their boolean
  counterparts. Other strings will cause an error to be thrown.
</li><li class="listitem">
The <code class="literal">in</code> query (a synonym for the <code class="literal">terms</code> query) has been removed
</li><li class="listitem">
The <code class="literal">geo_bbox</code> query (a synonym for the <code class="literal">geo_bounding_box</code> query) has been removed
</li><li class="listitem">
The <code class="literal">mlt</code> query (a synonym for the <code class="literal">more_like_this</code> query) has been removed
</li><li class="listitem">
The <code class="literal">fuzzy_match</code> and <code class="literal">match_fuzzy</code> query (synonyma for the <code class="literal">match</code> query) have been removed
</li><li class="listitem">
The <code class="literal">terms</code> query now always returns scores equal to <code class="literal">1</code> and is not subject to
  <code class="literal">indices.query.bool.max_clause_count</code> anymore.
</li><li class="listitem">
The deprecated <code class="literal">indices</code> query has been removed.
</li><li class="listitem">
Support for empty query objects (<code class="literal">{ }</code>) has been removed from the query DSL.
  An error is thrown whenever an empty query object is provided.
</li><li class="listitem">
The deprecated <code class="literal">minimum_number_should_match</code> parameter in the <code class="literal">bool</code> query has
  been removed, use <code class="literal">minimum_should_match</code> instead.
</li><li class="listitem">
The <code class="literal">query_string</code> query now correctly parses the maximum number of
  states allowed when
  "<a class="ulink" href="https://en.wikipedia.org/wiki/Powerset_construction#Complexity" target="_top">determinizing</a>"
  a regex as <code class="literal">max_determinized_states</code> instead of the typo
  <code class="literal">max_determined_states</code>.
</li><li class="listitem">
The <code class="literal">query_string</code> query no longer accepts <code class="literal">enable_position_increment</code>, use
  <code class="literal">enable_position_increments</code> instead.
</li><li class="listitem">
For <code class="literal">geo_distance</code> queries, sorting, and aggregations the <code class="literal">sloppy_arc</code> option
  has been removed from the <code class="literal">distance_type</code> parameter.
</li><li class="listitem">
The <code class="literal">geo_distance_range</code> query, which was deprecated in 5.0, has been removed.
</li><li class="listitem">
The <code class="literal">optimize_bbox</code> parameter has been removed from <code class="literal">geo_distance</code> queries.
</li><li class="listitem">
The <code class="literal">ignore_malformed</code> and <code class="literal">coerce</code> parameters have been removed from
  <code class="literal">geo_bounding_box</code>, <code class="literal">geo_polygon</code>, and <code class="literal">geo_distance</code> queries.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_search_shards_api"></a>Search shards API<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The search shards API no longer accepts the <code class="literal">type</code> url parameter, which didn’t
have any effect in previous versions.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_to_the_profile_api"></a>Changes to the Profile API<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
The <code class="literal">"time"</code> field showing human readable timing output has been replaced by the <code class="literal">"time_in_nanos"</code>
  field which displays the elapsed time in nanoseconds. The <code class="literal">"time"</code> field can be turned on by adding
  <code class="literal">"?human=true"</code> to the request url. It will display a rounded, human readable time value.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_scoring_changes"></a>Scoring changes<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_query_normalization"></a>Query normalization<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Query normalization has been removed. This means that the TF-IDF similarity no
longer tries to make scores comparable across queries and that boosts are now
integrated into scores as simple multiplicative factors.</p><p>Other similarities are not affected as they did not normalize scores and
already integrated boosts into scores as multiplicative factors.</p><p>See <a class="ulink" href="https://issues.apache.org/jira/browse/LUCENE-7347" target="_top"><code class="literal">LUCENE-7347</code></a> for more
information.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_coordination_factors"></a>Coordination factors<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/migration/migrate_6_0/search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4></div></div></div><p>Coordination factors have been removed from the scoring formula. This means that
boolean queries no longer score based on the number of matching clauses.
Instead, they always return the sum of the scores of the matching clauses.</p><p>As a consequence, use of the TF-IDF similarity is now discouraged as this was
an important component of the quality of the scores that this similarity
produces. BM25 is recommended instead.</p><p>See <a class="ulink" href="https://issues.apache.org/jira/browse/LUCENE-7347" target="_top"><code class="literal">LUCENE-7347</code></a> for more
information.</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="_delete_by_query_api_requires_an_explicit_query.html">
              « 
              Delete by Query API requires an explicit query</a>
           
        </span><span class="next">
           
          <a href="breaking_60_aggregations_changes.html">Aggregations changes
               »
            </a></span></div></body></html>