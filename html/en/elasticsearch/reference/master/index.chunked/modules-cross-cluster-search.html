<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Cross cluster search
        | Elasticsearch Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [master]" /><link rel="up" href="modules.html" title="Modules" /><link rel="prev" href="modules-tribe.html" title="Tribe node" /><link rel="next" href="index-modules.html" title="Index Modules" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/master" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="modules.html">Modules</a></span> » <span class="breadcrumb-node">Cross cluster search</span></div><div xmlns="" class="navheader"><span class="prev"><a href="modules-tribe.html">
              « 
              Tribe node</a>
           
        </span><span class="next">
           
          <a href="index-modules.html">Index Modules
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="modules-cross-cluster-search"></a>Cross cluster search<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><div xmlns="" class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p></div></div><p>The <span class="emphasis"><em>cross cluster search</em></span> feature allows any node to act as a federated client across
multiple clusters. In contrast to the <span class="emphasis"><em>tribe</em></span> feature, a  <span class="emphasis"><em>cross cluster search</em></span> node won’t
join the remote cluster, instead it connects to a remote cluster in a light fashion in order to execute
federated search requests.</p><p>The <span class="emphasis"><em>cross cluster search</em></span> feature works by configuring a remote cluster in the cluster state and connects only to a
limited number of nodes in the remote cluster. Each remote cluster is referenced by a name and a list of seed nodes.
Those seed nodes are used to discover other nodes eligible as so-called <span class="emphasis"><em>gateway nodes</em></span>. Each node in a cluster that
has remote clusters configured connects to one or more <span class="emphasis"><em>gateway nodes</em></span> and uses them to federate search requests to
the remote cluster.</p><p>Remote clusters can either be configured as part of the <code class="literal">elasticsearch.yml</code> file or be dynamically updated via
the <a class="link" href="cluster-update-settings.html" title="Cluster Update Settings">cluster settings API</a>. If a remote cluster is configured via <code class="literal">elasticsearch.yml</code> only
the nodes with the configuration set will be connecting to the remote cluster in which case federated search requests
will have to be sent specifically to those nodes. Remote clusters set via the
<a class="link" href="cluster-update-settings.html" title="Cluster Update Settings">cluster settings API</a> will be available on every node in the cluster.</p><p>The <code class="literal">elasticsearch.yml</code> config file for a <span class="emphasis"><em>cross cluster search</em></span> node just needs to list the
remote clusters that should be connected to, for instance:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">search:
    remote:
        cluster_one: <a id="CO295-1"></a><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span>
            seeds: 127.0.0.1:9300
        cluster_two: <a id="CO295-2"></a><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span>
            seeds: 127.0.0.1:9301</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO295-1"><span xmlns=""><img src="images/icons/callouts/1.png" alt="" /></span></a> <a href="#CO295-2"><span xmlns=""><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>
<code class="literal">cluster_one</code> and <code class="literal">cluster_two</code> are arbitrary cluster aliases representing the connection to each cluster.
These names are subsequently used to distinguish between local and remote indices.
</p></td></tr></table></div><h3><a id="_using_cross_cluster_search"></a>Using cross cluster search<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>To search the <code class="literal">twitter</code> index on remote cluster <code class="literal">cluster_1</code> the index name must be prefixed with the cluster alias
separated by a <code class="literal">:</code> character:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">POST /cluster_one:twitter/tweet/_search
{
    "match_all": {}
}</pre></div><p>In contrast to the <code class="literal">tribe</code> feature cross cluster search can also search indices with the same name on different
clusters:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">POST /cluster_one:twitter,twitter/tweet/_search
{
    "match_all": {}
}</pre></div><p>Search results are disambiguated the same way as the indices are disambiguated in the request. Even if index names are
identical these indices will be treated as different indices when results are merged. All results retrieved from a
remote index
will be prefixed with their remote cluster name:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js"> {
  "took" : 89,
  "timed_out" : false,
  "_shards" : {
    "total" : 10,
    "successful" : 10,
    "failed" : 0
  },
  "hits" : {
    "total" : 2,
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "cluster_one:twitter",
        "_type" : "tweet",
        "_id" : "1",
        "_score" : 1.0,
        "_source" : {
          "user" : "kimchy",
          "postDate" : "2009-11-15T14:12:12",
          "message" : "trying out Elasticsearch"
        }
      },
      {
        "_index" : "twitter",
        "_type" : "tweet",
        "_id" : "1",
        "_score" : 1.0,
        "_source" : {
          "user" : "kimchy",
          "postDate" : "2009-11-15T14:12:12",
          "message" : "trying out Elasticsearch"
        }
      }
    ]
  }
}</pre></div><h3><a id="_cross_cluster_search_settings"></a>Cross cluster search settings<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/modules/cross-cluster-search.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<code class="literal">search.remote.connections_per_cluster</code>
</span></dt><dd>
  The number of nodes to connect to per remote cluster. The default is <code class="literal">3</code>.
</dd><dt><span class="term">
<code class="literal">search.remote.initial_connect_timeout</code>
</span></dt><dd>
  The time to wait for remote connections to be established when the node starts. The default is <code class="literal">30s</code>.
</dd><dt><span class="term">
<code class="literal">search.remote.node.attr</code>
</span></dt><dd>
  A node attribute to filter out nodes that are eligible as a gateway node in
  the remote cluster. For instance a node can have a node attribute
  <code class="literal">node.attr.gateway: true</code> such that only nodes with this attribute will be
  connected to if <code class="literal">search.remote.node.attr</code> is set to <code class="literal">gateway</code>.
</dd><dt><span class="term">
<code class="literal">search.remote.connect</code>
</span></dt><dd>
 By default, any node in the cluster can act as a cross-cluster client and connect to remote clusters.
 The <code class="literal">search.remote.connect</code> setting can be set to <code class="literal">false</code> (defaults to <code class="literal">true</code>) to prevent certain nodes from
 connecting to remote clusters. Cross-cluster search requests must be sent to a node that is allowed to act as a
 cross-cluster client.
</dd></dl></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="modules-tribe.html">
              « 
              Tribe node</a>
           
        </span><span class="next">
           
          <a href="index-modules.html">Index Modules
               »
            </a></span></div></body></html>