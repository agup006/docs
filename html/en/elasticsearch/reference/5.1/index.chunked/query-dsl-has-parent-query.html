<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Has Parent Query
        | Elasticsearch Reference [5.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.1]" /><link rel="up" href="joining-queries.html" title="Joining queries" /><link rel="prev" href="query-dsl-has-child-query.html" title="Has Child Query" /><link rel="next" href="query-dsl-parent-id-query.html" title="Parent Id Query" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.1" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.1]
    </a></span> » <span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span> » <span class="breadcrumb-link"><a href="joining-queries.html">Joining queries</a></span> » <span class="breadcrumb-node">Has Parent Query</span></div><div xmlns="" class="navheader"><span class="prev"><a href="query-dsl-has-child-query.html">
              « 
              Has Child Query</a>
           
        </span><span class="next">
           
          <a href="query-dsl-parent-id-query.html">Parent Id Query
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="query-dsl-has-parent-query"></a>Has Parent Query<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/query-dsl/has-parent-query.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <code class="literal">has_parent</code> query accepts a query and a parent type. The query is
executed in the parent document space, which is specified by the parent
type. This query returns child documents which associated parents have
matched. For the rest <code class="literal">has_parent</code> query has the same options and works
in the same manner as the <code class="literal">has_child</code> query.</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "has_parent" : {
            "parent_type" : "blog",
                "query" : {
                    "term" : {
                        "tag" : "something"
                    }
                }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><h4><a id="_scoring_capabilities_2"></a>Scoring capabilities<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/query-dsl/has-parent-query.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The <code class="literal">has_parent</code> also has scoring support. The default is <code class="literal">false</code> which
ignores the score from the parent document. The score is in this
case equal to the boost on the <code class="literal">has_parent</code> query (Defaults to 1). If
the score is set to <code class="literal">true</code>, then the score of the matching parent
document is aggregated into the child documents belonging to the
matching parent document. The score mode can be specified with the
<code class="literal">score</code> field inside the <code class="literal">has_parent</code> query:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "has_parent" : {
            "parent_type" : "blog",
                "score" : true,
                "query" : {
                    "term" : {
                        "tag" : "something"
                    }
                }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><h4><a id="_ignore_unmapped_2"></a>Ignore Unmapped<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/query-dsl/has-parent-query.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>When set to <code class="literal">true</code> the <code class="literal">ignore_unmapped</code> option will ignore an unmapped <code class="literal">type</code>
and will not match any documents for this query. This can be useful when
querying multiple indexes which might have different mappings. When set to
<code class="literal">false</code> (the default value) the query will throw an exception if the <code class="literal">type</code>
is not mapped.</p><h4><a id="_sorting_2"></a>Sorting<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/query-dsl/has-parent-query.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Child documents can’t be sorted by fields in matching parent documents via the
regular sort options. If you need to sort child documents by field in the parent
documents then you can should use the <code class="literal">function_score</code> query and then just sort
by <code class="literal">_score</code>.</p><p>Sorting tags by parent document' <code class="literal">view_count</code> field:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /_search
{
    "query": {
        "has_parent" : {
            "parent_type" : "blog",
            "score" : true,
            "query" : {
                "function_score" : {
                    "script_score": {
                        "script": "_score * doc['view_count'].value"
                    }
                }
            }
        }
    }
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="query-dsl-has-child-query.html">
              « 
              Has Child Query</a>
           
        </span><span class="next">
           
          <a href="query-dsl-parent-id-query.html">Parent Id Query
               »
            </a></span></div></body></html>