<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Search Shards API
        | Elasticsearch Reference [5.1]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [5.1]" /><link rel="up" href="search.html" title="Search APIs" /><link rel="prev" href="multi-search-template.html" title="Multi Search Template" /><link rel="next" href="search-suggesters.html" title="Suggesters" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Docs/Elasticsearch/Reference/5.1" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [5.1]
    </a></span> » <span class="breadcrumb-link"><a href="search.html">Search APIs</a></span> » <span class="breadcrumb-node">Search Shards API</span></div><div xmlns="" class="navheader"><span class="prev"><a href="multi-search-template.html">
              « 
              Multi Search Template</a>
           
        </span><span class="next">
           
          <a href="search-suggesters.html">Suggesters
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="search-shards"></a>Search Shards API<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/search/search-shards.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The search shards api returns the indices and shards that a search request would
be executed against. This can give useful feedback for working out issues or
planning optimizations with routing and shard preferences. When filtered aliases
are used, the filter is returned as part of the <code class="literal">indices</code> section <span xmlns="" class="added">
      [<span class="version">5.1.1</span>]
      <span class="detail">Added in 5.1.1. 
</span></span>.</p><p>The <code class="literal">index</code> and <code class="literal">type</code> parameters may be single values, or comma-separated.</p><p>The <code class="literal">type</code> parameter is deprecated <span xmlns="" class="deprecated">
      [<span class="version">5.1.1</span>]
      <span class="detail">Deprecated in 5.1.1. 
was ignored in previous versions
</span></span>.</p><h3><a id="_usage"></a>Usage<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/search/search-shards.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Full example:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /twitter/_search_shards</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><p>This will yield the following result:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "nodes": ...,
  "indices" : {
    "twitter": { }
  },
  "shards": [
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 0,
        "state": "STARTED",
        "allocation_id": {"id":"0TvkCyF7TAmM1wHP4a42-A"},
        "relocating_node": null
      }
    ],
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 1,
        "state": "STARTED",
        "allocation_id": {"id":"fMju3hd1QHWmWrIgFnI4Ww"},
        "relocating_node": null
      }
    ],
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 2,
        "state": "STARTED",
        "allocation_id": {"id":"Nwl0wbMBTHCWjEEbGYGapg"},
        "relocating_node": null
      }
    ],
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 3,
        "state": "STARTED",
        "allocation_id": {"id":"bU_KLGJISbW0RejwnwDPKw"},
        "relocating_node": null
      }
    ],
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 4,
        "state": "STARTED",
        "allocation_id": {"id":"DMs7_giNSwmdqVukF7UydA"},
        "relocating_node": null
      }
    ]
  ]
}</pre></div><p>And specifying the same request, this time with a routing value:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">GET /twitter/_search_shards?routing=foo,baz</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><p>This will yield the following result:</p><div xmlns="" class="pre_wrapper"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">{
  "nodes": ...,
  "indices" : {
      "twitter": { }
  },
  "shards": [
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 0,
        "state": "STARTED",
        "allocation_id": {"id":"0TvkCyF7TAmM1wHP4a42-A"},
        "relocating_node": null
      }
    ],
    [
      {
        "index": "twitter",
        "node": "JklnKbD7Tyqi9TP3_Q_tBg",
        "primary": true,
        "shard": 1,
        "state": "STARTED",
        "allocation_id": {"id":"fMju3hd1QHWmWrIgFnI4Ww"},
        "relocating_node": null
      }
    ]
  ]
}</pre></div><p>This time the search will only be executed against two of the shards, because
routing values have been specified.</p><h3><a id="_all_parameters"></a>All parameters:<a xmlns="" href="https://github.com/elastic/elasticsearch/edit/5.1/docs/reference/search/search-shards.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="horizontal"><table cellpadding="4px" border="0"><colgroup><col /><col /></colgroup><tbody valign="top"><tr><td valign="top">
<p>
<code class="literal">routing</code>
</p>
</td><td valign="top">
<p>
    A comma-separated list of routing values to take into account when
    determining which shards a request would be executed against.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">preference</code>
</p>
</td><td valign="top">
<p>
    Controls a <code class="literal">preference</code> of which shard replicas to execute the search
    request on. By default, the operation is randomized between the shard
    replicas. See the <a class="ulink" href="search-request-preference.html" target="_top">preference</a>
    documentation for a list of all acceptable values.
</p>
</td></tr><tr><td valign="top">
<p>
<code class="literal">local</code>
</p>
</td><td valign="top">
<p>
    A boolean value whether to read the cluster state locally in order to
    determine where shards are allocated instead of using the Master node’s
    cluster state.
</p>
</td></tr></tbody></table></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="multi-search-template.html">
              « 
              Multi Search Template</a>
           
        </span><span class="next">
           
          <a href="search-suggesters.html">Suggesters
               »
            </a></span></div></body></html>